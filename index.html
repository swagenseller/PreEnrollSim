<!DOCTYPE html>
<style>
body{
    background-color: #E6E6E6;
}
.button {
    background-color: steelblue;
    border: none;
    border-radius: 4px;
    color: black;
    padding: 12px 28px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 2px 2px;
    cursor: pointer;
}    
 
p{
    text-indent: 40px;
}
.bar{
    fill: steelblue;
    fill-opacity: .9;
}
 
.axis text{
    font: Times;
    font-size: 12px;
    font-weight: bold;
}
 
   
.axis path,
.axis line {
    fill: none;
    stroke: black;
    shape-rendering: crispEdges;
}
.tooltip {
        position: absolute;
        width: 200px;
        height: auto;
        padding: 10px;
        background-color: white;
        -webkit-border-radius: 10px;
        -moz-border-radius: 10px;
        border-radius: 10px;
        -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
        -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
        box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
        pointer-events: none;
}
 
.tooltip.hidden {
        display: none;
}
 
</style>
 
 <body>
    <button class="button" onclick = "increment101()">Increment</button>
    <button class="button"onclick = "empty()">Empty Csv</button>
     
    <script type= "text/javascript" src="https://d3js.org/d3.v3.min.js"></script>
    <label><input type="checkbox">Switch Alphabetically/Total</label>  
      
    <div id="tooltip" class="hidden">        
    </div>
    <input class="button" type = "button" value ="Reload Simulation Data" onclick = "location.reload();" />
    <div class="page-header">
       
        <select name="my_menu1" id = "my_menu1" size="1">
                <option value="CMPE107">CMPE107</option>   
                <option value="CMPE12">CMPE12</option>
                <option value="CMPE16">CMPE16</option>
                <option value="CMPS101">CMPS101</option>
                <option value="CMPS102">CMPS102</option>
                <option value="CMPS104A">CMPS104A</option>
                <option value="CMPS112">CMPS112</option>
                <option value="CMPS12A">CMPS12A</option>
                <option value="CMPS12B">CMPS12B</option>
                <option value="CMPS130">CMPS130</option>
            </select>
        <select name="my_menu2" id = "my_menu2" size="1">
                <option value="CMPE107">CMPE107</option>   
                <option value="CMPE12">CMPE12</option>
                <option value="CMPE16">CMPE16</option>
                <option value="CMPS101">CMPS101</option>
                <option value="CMPS102">CMPS102</option>
                <option value="CMPS104A">CMPS104A</option>
                <option value="CMPS112">CMPS112</option>
                <option value="CMPS12A">CMPS12A</option>
                <option value="CMPS12B">CMPS12B</option>
                <option value="CMPS130">CMPS130</option>
            </select>
        <select name="my_menu3" id = "my_menu3" size="1">
                <option value="CMPE107">CMPE107</option>   
                <option value="CMPE12">CMPE12</option>
                <option value="CMPE16">CMPE16</option>
                <option value="CMPS101">CMPS101</option>
                <option value="CMPS102">CMPS102</option>
                <option value="CMPS104A">CMPS104A</option>
                <option value="CMPS112">CMPS112</option>
                <option value="CMPS12A">CMPS12A</option>
                <option value="CMPS12B">CMPS12B</option>
                <option value="CMPS130">CMPS130</option>
            </select>
       
       
           <h1><center>Fall 2016 Enrollment data</center></h1>      
      </div>
      <p><center>Enrollment data for Computer Science classes of Fall 2016. Compares the most enrolled class to the least enrolled class.</center></p>
<script>  
     
var margin = {top: 10, right: 40, bottom: 150, left: 50},
    width = 860 - margin.left - margin.right,  //760
    height = 500 - margin.top - margin.bottom;
   
 
var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      
var x = d3.time.scale().range([0, width]);
var y = d3.scale.linear().range([height, 0]);  
       
var xScale = d3.scale.ordinal()
    .rangeRoundBands([0, width], 0.1);
 
var yScale = d3.scale.linear()
    .range([height, 0]);
 
var xAxis = d3.svg.axis()
    .scale(xScale)
    .orient("bottom");
//added tick marks to the y-axis and implements the "$" sign
var yAxis = d3.svg.axis()
    .scale(yScale)
    .orient("left")
    .ticks(8);
 
var div = d3.select("body").append("bar")  
    .attr("class", "tooltip")              
    .style("opacity", 0);
 
d3.csv("Fall2016EnrollmentTotal.csv",function(error, data){
    data.forEach(function(d) {
        d.key = d.key;
        d.value = +d.value;
    });
   
    xScale.domain(data.map(function(d){ return d.key; }));
    yScale.domain([0,d3.max(data, function(d) {return d.value; })]);
   
    //xAxis labels
   
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis)
        .selectAll("text")
        .attr("dx", " -.8em")
        .attr("dy", ".50em")
        .style("text-anchor", "middle")
        .attr("font-size", "10px")
          
    svg.append("g")
        .attr("class", "y axis")
        .attr("transform", "translate(0,0)")
        .call(yAxis);
    svg.append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", 0 - margin.left )
        .attr("x", 0-(height/2))
        .attr("dy", "1em")
        .style("text-anchor", "middle")
        .text("Total Enrolled Students per class");    
   
   
    svg.selectAll(".bar")
      .data(data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return xScale(d.key); })
      .attr("width", xScale.rangeBand())
      .attr("y", function(d) { return yScale(d.value); })
      .attr("height", function(d) { return height - yScale(d.value); })
      .on("mouseover", function(d) {      
           div.transition()      
              .duration(200)    
              .style("opacity", .9);    
           div.html( "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + d.key + " <br/>  # of students &nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; " + d.value )
               .style("left", (d3.event.pageX+20) + "px")    
               .style("top", (d3.event.pageY - 28) + "px");  
        //Show the tooltip
            d3.select(".tooltip").classed("hidden", false);
       })                
       .on("mouseout", function() {
 
//Hide the tooltip
     d3.select(".tooltip").classed("hidden", true);
    });
   
  d3.select("input").on("change", change);
 
  var sortTimeout = setTimeout(function() {
    d3.select("input").property("checked", true).each(change);
  }, 2000);
 
  function change() {
    clearTimeout(sortTimeout);
 
    var x0 = xScale.domain(data.sort(this.checked
        ? function(a, b) { return b.value - a.value; }
        : function(a, b) { return d3.ascending(a.key, b.key); })
        .map(function(d) { return d.key; }))
        .copy();
 
    svg.selectAll(".bar")
        .sort(function(a, b) { return x0(a.key) - x0(b.key); });
 
    var transition = svg.transition().duration(750),
        delay = function(d, i) { return i * 50; };
 
    transition.selectAll(".bar")
        .delay(delay)
        .attr("x", function(d) { return x0(d.key); });
 
    transition.select(".x.axis")
        .call(xAxis)
      .selectAll("g")
        .delay(delay);
  }
   
   
    window.updateData = function() {
     
    // Select the section we want to apply our changes to
    var svg = d3.select("body").transition();
 
    // Make the changes
       
        svg.select(".x.axis") // change the x axis
            .duration(750)
            .call(xAxis);
        svg.select(".y.axis") // change the y axis
            .duration(750)
            .call(yAxis);
  //  
}
 
      
     window.increment101 = function() {
        var dropdown1 = document.getElementById("my_menu1");
         var value1 = dropdown1.options[dropdown1.selectedIndex].value;
         var dropdown2 = document.getElementById("my_menu2");
         var value2 = dropdown2.options[dropdown2.selectedIndex].value;
         var dropdown3 = document.getElementById("my_menu3");
         var value3 = dropdown3.options[dropdown3.selectedIndex].value;
        
         data.forEach(function(d){
         if(d.key == value1) {
            d.value+=+1;
        }
        })
        
         data.forEach(function(d){
         if(d.key == value2) {
            d.value+=+1;
        }
        })
        
         data.forEach(function(d){
         if(d.key == value3) {
            d.value+=+1;
        }
        })
    
        xScale.domain(data.map(function(d){ return d.key; }));
        yScale.domain([0,d3.max(data, function(d) {return d.value; })]);
        svg.selectAll(".bar").remove();
        svg.selectAll(".bar")
           .data(data)
        .enter().append("rect")
           .attr("class", "bar")
           .attr("x", function(d) { return xScale(d.key); })
           .attr("width", xScale.rangeBand())
           .attr("y", function(d) { return yScale(d.value); })
           .attr("height", function(d) { return height - yScale(d.value); })
           .on("mouseover", function(d) {      
           
        div.transition()      
           .duration(200)    
           .style("opacity", .9);    
        div.html( "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + d.key + " <br/>  # of students &nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; " + d.value )
                .style("left", (d3.event.pageX+20) + "px")    
                .style("top", (d3.event.pageY - 28) + "px");  
               
       //Show the tooltip
        d3.select(".tooltip").classed("hidden", false);
        })                
        .on("mouseout", function() {
        //Hide the tooltip
        d3.select(".tooltip").classed("hidden", true);
 
        });
        updateData();    
 
    }
    /////////////// 
window.empty = function() {
        data.forEach(function(d){ 
            d.value = 0;
            
        })
        console.log(data);
//console.log(d.value);           
    xScale.domain(data.map(function(d){ return d.key; }));
    yScale.domain([0,d3.max(data, function(d) {return d.value; })]);
    svg.selectAll(".bar").remove();
      
    svg.selectAll(".bar")
      .data(data)
   .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return xScale(d.key); })
      .attr("width", xScale.rangeBand())
      .attr("y", function(d) { return yScale(d.value); })
      .attr("height", function(d) { return height - yScale(d.value); })
      .on("mouseover", function(d) {             
        div.transition()      
                .duration(200)    
                .style("opacity", .9);    
            div.html( "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + d.key + " <br/>  # of students &nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; " + d.value )
                .style("left", (d3.event.pageX+20) + "px")    
                .style("top", (d3.event.pageY - 28) + "px");  
               
        //Show the tooltip
        d3.select(".tooltip").classed("hidden", false);
        })                
        .on("mouseout", function() { 
        //Hide the tooltip
        d3.select(".tooltip").classed("hidden", true);
        });
       updateData();
           
       }
    ////////////////////////   
});
       
     </script> 

       <div class='row'>
        <div id="footer">
          <div class="container">
            <div class="row-1">
              <h3> Created by: </h3>
                  Jeff Wagenseller and Zach Reisenfeld <br>
 
              <h3>Created for: </h3> CMPS165, Data Programming for Visualization, Fall 2016
            </div><!--/col-sm-3-->
            <br>
            <div class="col-sm-3">